{% if computer.users.length == 0 %}
<div class="empty-state">
  <p>No users found on this computer.</p>
  <p class="text-muted">Users with UID >= 1000 will appear here once the agent reports them.</p>
</div>
{% else %}
<table class="table">
  <thead>
    <tr>
      <th>Username</th>
      <th>UID</th>
      <th>Status</th>
      <th>Home Directory</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for user in computer.users %}
    <tr class="{% if user.is_locked %}row-locked{% endif %}">
      <td>
        <strong>{{ user.username }}</strong>
        {% if computer.current_user == user.username %}
          <span class="badge badge-success">Active</span>
        {% endif %}
      </td>
      <td>{{ user.uid }}</td>
      <td>
        {% if user.is_locked %}
          <span class="status-badge status-locked">
            ğŸ”’ Locked
          </span>
        {% elif user.is_logged_in or computer.current_user == user.username %}
          <span class="status-badge status-online">
            â— Logged in
          </span>
        {% else %}
          <span class="status-badge status-offline">
            â—‹ Offline
          </span>
        {% endif %}
      </td>
      <td class="text-muted">{{ user.home_dir or '-' }}</td>
      <td>
        {% if computer.status == 'online' %}
          <div class="btn-group">
            {% if user.is_locked %}
              <button 
                class="btn btn-sm btn-success"
                hx-post="/computers/{{ computer.id }}/user/{{ user.username }}/enable"
                hx-target="#users-list"
                hx-swap="innerHTML"
                hx-confirm="Enable user {{ user.username }}?"
              >
                Enable
              </button>
            {% else %}
              <button 
                class="btn btn-sm btn-warning"
                hx-post="/computers/{{ computer.id }}/user/{{ user.username }}/disable"
                hx-target="#users-list"
                hx-swap="innerHTML"
                hx-confirm="Disable user {{ user.username }}? They will not be able to log in."
              >
                Disable
              </button>
            {% endif %}
            
            {% if user.is_logged_in or computer.current_user == user.username %}
              <button 
                class="btn btn-sm btn-danger"
                hx-post="/computers/{{ computer.id }}/user/{{ user.username }}/logout"
                hx-target="#users-list"
                hx-swap="innerHTML"
                hx-confirm="Force logout user {{ user.username }}? Any unsaved work will be lost."
              >
                Logout
              </button>
            {% endif %}
          </div>
        {% else %}
          <span class="text-muted">Computer offline</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% if pendingCommands.length > 0 %}
<div class="pending-commands">
  <h4>Pending Commands</h4>
  <ul>
    {% for cmd in pendingCommands %}
    <li>
      <span class="badge badge-info">{{ cmd.command_type }}</span>
      {{ cmd.target_user }}
      <span class="text-muted">({{ cmd.status }})</span>
    </li>
    {% endfor %}
  </ul>
</div>
{% endif %}
{% endif %}
